<div id="page-matches" style="display: none;">
	<h1 align="center" style="font-family: robotoBlack">Matches</h1>
	<center><select id="sortMatchesField">
		<option>matchNumber</option>
		<option>redScore</option>
		<option>blueScore</option>
		<option>totalScore</option>
		<option>redGears</option>
		<option>blueGears</option>
		<option>totalGears</option>
		<option>redGrade</option>
		<option>blueGrade</option>
		<option>totalGrade</option>
	</select>
	<button type="button" class="btn btn-info" id="sortMatchesButton">Sort</button>
	</center>
	<table class="table" align="center" style="width: 85%;">
		<thead>
			<tr>
				<th>#</th>
				<th>Red</th>
				<th>Blue</th>
				<th>Total</th>
				<th>R1</th>
				<th>R2</th>
				<th>R3</th>
				<th>RGears</th>
				<th>RGrade</th>
				<th>B1</th>
				<th>B2</th>
				<th>B3</th>
				<th>BGears</th>
				<th>BGrade</th>
			</tr>
		</thead>
		<tbody id="matchesTbody"></tbody>
	</table>
</div>

<script type="text/javascript">
	
	var allMatches = []
	for (var matchNumber in schedule) {
		var redTeams = schedule[matchNumber].slice(0,3), blueTeams = schedule[matchNumber].slice(3)
		var redScore = 0, blueScore = 0
		var redGears = 0, blueGears = 0
		var redGrade = 0, blueGrade = 0
		for (var index in redTeams) {
			redScore += expectedScoreByTeam[redTeams[index]]
			redGears += averagesForMatch[redTeams[index]].gears4NZ
			redGrade += averagesForMatch[redTeams[index]].gradeOverall
			//redGrade += normalizedGradesByTeam[redTeams[index]].overall
			//you could use normalized grades, but you'd have to reenable going through all the teams one by one in a loop in teams.html to process their normalized grades early
		}
		for (var index in blueTeams) {
			blueScore += expectedScoreByTeam[blueTeams[index]]
			blueGears += averagesForMatch[blueTeams[index]].gears4NZ
			blueGrade += averagesForMatch[blueTeams[index]].gradeOverall
			//blueGrade += normalizedGradesByTeam[blueTeams[index]].overall

		}
		redGrade /= 3
		blueGrade /= 3

		var match = {
			matchNumber: matchNumber,
			redTeams: redTeams,
			blueTeams: blueTeams,
			redScore: redScore,
			blueScore: blueScore,
			totalScore: redScore + blueScore,
			totalGears: redGears + blueGears,
			totalGrade: redGrade + blueGrade,
			redGears: redGears,
			blueGears: blueGears,
			redGrade: redGrade,
			blueGrade: blueGrade
		}
		allMatches.push(match)
	}

	function drawTable(sortBy) { // sortBy is ["matchNumber", "redScore", "blueScore", "totalScore", "redGears", "blueGears", "totalGears", "redGrade", "blueGrade", "totalGrade"]
		allMatches.sort(function(a, b) {
			if (sortBy === "matchNumber")
				return parseInt(a[sortBy]) - parseInt(b[sortBy])
			else
				return parseInt(b[sortBy]) - parseInt(a[sortBy])
		})
		$("#matchesTbody").html('')
		for (var index in allMatches) {
			var m = allMatches[index]
			html = `<tr>`
			html += `<td>${m.matchNumber}</td>`
			html += `<td style="color: #C95C54;">${m.redScore.toFixed(1)}</td>`
			html += `<td style="color: #4679B2;">${m.blueScore.toFixed(1)}</td>`
			html += `<td style="color: #74B566;">${m.totalScore.toFixed(1)}</td>`
			html += `<td>${m.redTeams[0]}</td><td>${m.redTeams[1]}</td><td>${m.redTeams[2]}</td>`
			html += `<td style="color: #C95C54;">${m.redGears.toFixed(1)}</td>`
			html += `<td><span class="label label-default" style="background-color: #551A8B;">${m.redGrade.toFixed(1)}</span></td>`
			html += `<td>${m.blueTeams[0]}</td><td>${m.blueTeams[1]}</td><td>${m.blueTeams[2]}</td>`
			html += `<td style="color: #4679B2;">${m.blueGears.toFixed(1)}</td>`
			html += `<td><span class="label label-default" style="background-color: #551A8B;">${m.blueGrade.toFixed(1)}</span></td>`
			html += `</tr>`
			$("#matchesTbody").append(html)
		}
	}

	$("#sortMatchesButton").click(function() {
		var sortBy = $("#sortMatchesField").val()
		drawTable(sortBy)
	})

	drawTable("matchNumber")

</script>